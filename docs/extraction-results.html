<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>SOF Extraction Results • Cargo Laytime</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="assets/css/theme.css" />
	<link rel="stylesheet" href="assets/css/extraction-results.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
	<!-- Top Navigation Bar -->
	<nav class="top-nav">
		<div class="nav-container">
			<div class="nav-left">
				<div class="logo">
					<i class="fas fa-ship"></i>
					<span>Cargo LayTime</span>
				</div>
			</div>
			
			<div class="nav-right">
				<div class="user-profile" id="userProfile">
					<div class="avatar" id="avatar">
						<i class="fas fa-user"></i>
					</div>
					<div class="dropdown-menu" id="dropdownMenu">
						<div class="dropdown-item" onclick="showAccountDetails()">
							<i class="fas fa-user-cog"></i>
							<span>Account Details</span>
						</div>
						<div class="dropdown-item" onclick="logout()">
							<i class="fas fa-sign-out-alt"></i>
							<span>Log Out</span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</nav>

	<main class="workspace">
		<div class="workspace-card">
			<div class="topbar">
				<div class="breadcrumb">
					<span>SOF Extraction Results</span>
				</div>
				<div class="actions">
					<button class="action-btn btn-primary" id="calculateBtn" onclick="calculateLaytime()">
						<i class="fas fa-calculator"></i> Calculate Laytime
					</button>
				</div>
			</div>

			<!-- Split Layout: Form on Left, Results on Right -->
			<div class="split-layout">
				<!-- Left Panel: Vessel/Voyage Information Form -->
				<div class="left-panel">
					<div class="panel-header">
						<h2><i class="fas fa-ship"></i> Vessel & Voyage Details</h2>
						<div class="success-banner" id="successBanner">
							<div class="success-icon">✅</div>
							<div>
								<h3>SOF Document Parsed Successfully</h3>
								<p>Review and edit the extracted details below</p>
							</div>
						</div>
					</div>
					
					<div class="data-form" id="data-form">
						<!-- PDF Upload Section -->
						<div class="pdf-upload-section">
							<h3><i class="fas fa-upload"></i> Upload PDF for Processing</h3>
							<div class="upload-area">
								<input type="file" id="pdfFileInput" accept=".pdf" style="display: none;" />
								<button class="btn btn-primary" onclick="document.getElementById('pdfFileInput').click()">
									<i class="fas fa-file-pdf"></i> Choose PDF File
								</button>
								<span id="selectedFileName" class="selected-file">No file selected</span>
							</div>
							<button class="btn btn-success" id="processPdfBtn" onclick="processSelectedPDF()" disabled>
								<i class="fas fa-cogs"></i> Process PDF
							</button>
						</div>
						
						<div class="form-grid">
							<div class="form-item">
								<label class="label">VESSEL NAME</label>
								<input class="input-sm" id="vessel-name" placeholder="e.g., M.V. ORION TRADER" />
							</div>
							<div class="form-item">
								<label class="label">MASTER</label>
								<input class="input-sm" id="master" placeholder="e.g., CAPTAIN A. K. SINGH" />
							</div>
							<div class="form-item">
								<label class="label">AGENT</label>
								<input class="input-sm" id="agent" placeholder="e.g., GLOBAL MARITIME SERVICES LTD" />
							</div>
							<div class="form-item">
								<label class="label">PORT OF LOADING</label>
								<input class="input-sm" id="port-loading" placeholder="e.g., Koh Sichang, Thailand" />
							</div>
							<div class="form-item">
								<label class="label">PORT OF DISCHARGE</label>
								<input class="input-sm" id="port-discharge" placeholder="e.g., New York, USA" />
							</div>
							<div class="form-item">
								<label class="label">CARGO</label>
								<input class="input-sm" id="cargo" placeholder="e.g., Bagged Rice" />
							</div>
							<div class="form-item">
								<label class="label">QUANTITY (MT)</label>
								<input class="input-sm" id="quantity" type="number" placeholder="e.g., 41998" />
							</div>
							<div class="form-item">
								<label class="label">ALLOWED LAYTIME (DAYS)</label>
								<input class="input-sm" id="allowed-laytime" type="number" placeholder="e.g., 5" />
							</div>
							<div class="form-item">
								<label class="label">DEMURRAGE ($/DAY)</label>
								<input class="input-sm" id="demurrage" type="number" placeholder="e.g., 5000" />
							</div>
							<div class="form-item">
								<label class="label">DISPATCH ($/DAY)</label>
								<input class="input-sm" id="dispatch" type="number" placeholder="e.g., 2500" />
							</div>
							<div class="form-item">
								<label class="label">RATE (MT/DAY)</label>
								<input class="input-sm" id="rate" type="number" placeholder="e.g., 1000" />
							</div>
						</div>
					</div>
				</div>

				<!-- Right Panel: Events Timeline Table -->
				<div class="right-panel" id="right-panel">
					<div class="panel-header">
						<h2><i class="fas fa-calendar-alt"></i> Chronology of Events</h2>
						<button class="btn btn-primary" onclick="addNewEvent()">
							<i class="fas fa-plus"></i> Add Event
						</button>
					</div>
					
					<!-- Events Table -->
					<div class="events-section">
						<div class="events-table">
							<table>
								<thead>
									<tr>
										<th>EVENTS</th>
										<th>DAY</th>
										<th>START DATE TIME</th>
										<th>END DATE TIME</th>
										<th>LAYTIME TIME UTILIZATION</th>
										<th>LAYTIME % UTILIZATION</th>
										<th>LAYTIME CONSUMED</th>
										<th>LAYTIME REMAINING</th>
										<th>ACTIONS</th>
									</tr>
								</thead>
								<tbody id="events-tbody">
									<!-- Events will be populated here -->
								</tbody>
							</table>
						</div>
					</div>

					<!-- Laytime Summary -->
					<div class="laytime-summary" id="laytimeSummary" style="display: none;">
						<div class="summary-grid">
							<div class="summary-item">
								<label>Total Laytime Used:</label>
								<span id="total-laytime">0.00 Days</span>
							</div>
							<div class="summary-item">
								<label>Laytime Remaining:</label>
								<span id="laytime-remaining">0.00 Days</span>
							</div>
							<div class="summary-item">
								<label>Demurrage Cost:</label>
								<span id="demurrage-cost">$0.00</span>
							</div>
							<div class="summary-item">
								<label>Dispatch Credit:</label>
								<span id="dispatch-credit">$0.00</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>

	<!-- Add Event Modal -->
	<div class="modal" id="addEventModal">
		<div class="modal-content">
			<div class="modal-header">
				<h3>Add New Event</h3>
				<button class="close-btn" onclick="closeAddEventModal()">×</button>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<label>Event Description</label>
					<input type="text" id="newEventDesc" placeholder="e.g., Loading Bags" />
				</div>
				<div class="form-group">
					<label>Date</label>
					<input type="date" id="newEventDate" />
				</div>
				<div class="form-group">
					<label>Start Time</label>
					<input type="time" id="newEventStart" />
				</div>
				<div class="form-group">
					<label>End Time</label>
					<input type="time" id="newEventEnd" />
				</div>
				<div class="form-group">
					<label>Remarks</label>
					<input type="text" id="newEventRemarks" placeholder="e.g., 1st shift" />
				</div>
			</div>
			<div class="modal-footer">
				<button class="btn btn-secondary" onclick="closeAddEventModal()">Cancel</button>
				<button class="btn btn-primary" onclick="saveNewEvent()">Add Event</button>
			</div>
		</div>
	</div>

	<!-- Edit Event Modal -->
	<div class="modal" id="editEventModal">
		<div class="modal-content">
			<div class="modal-header">
				<h3>Edit Event</h3>
				<button class="close-btn" onclick="closeEditEventModal()">×</button>
			</div>
			<div class="modal-body">
				<input type="hidden" id="editEventIndex" />
				<div class="form-group">
					<label>Event Description</label>
					<input type="text" id="editEventDesc" />
				</div>
				<div class="form-group">
					<label>Date</label>
					<input type="date" id="editEventDate" />
				</div>
				<div class="form-group">
					<label>Start Time</label>
					<input type="time" id="editEventStart" />
				</div>
				<div class="form-group">
					<label>End Time</label>
					<input type="time" id="editEventEnd" />
				</div>
				<div class="form-group">
					<label>Remarks</label>
					<input type="text" id="editEventRemarks" />
				</div>
			</div>
			<div class="modal-footer">
				<button class="btn btn-secondary" onclick="closeEditEventModal()">Cancel</button>
				<button class="btn btn-primary" onclick="saveEditedEvent()">Save Changes</button>
			</div>
		</div>
	</div>

	<!-- Loading Overlay -->
	<div class="loading-overlay" id="loadingOverlay" style="display: none;">
		<div class="loading-spinner">
			<i class="fas fa-spinner fa-spin"></i>
			<p id="loadingText">Processing...</p>
		</div>
	</div>

	<footer class="footer">
		<div class="container">
			<span>© <span id="year"></span> Cargo Laytime. All rights reserved.</span>
		</div>
	</footer>

	<script src="assets/js/app.js"></script>
	<script src="assets/js/extraction-results.js"></script>
</body>
</html>
